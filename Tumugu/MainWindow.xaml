<Window x:Class="Tumugu.MainWindow"
        xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Tumugu"
        mc:Ignorable="d"
        
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        TextElement.FontWeight="Medium"
        TextElement.FontSize="14"
        FontFamily="pack://application:,,,/MaterialDesignThemes.Wpf;component/Resources/Roboto/#Roboto"
        Title="MainWindow" Height="650" Width="800" BorderThickness="1" WindowStartupLocation="Manual"
        ResizeMode="CanResize" WindowStyle="None" Loaded="Window_Loaded">
    <!-- WindowChrome を使ってカスタムタイトルバーを作っている場合、
CaptionHeight のデフォルト値（約 30px）が 「ドラッグ領域」として確保されるため、
その高さ分だけ 上部に空白が強制的に入ります。
    解決策：CaptionHeight="0" を明示的に指定する

-->
    <WindowChrome.WindowChrome>
        <WindowChrome
            CaptionHeight="0"
            ResizeBorderThickness="5"
            GlassFrameThickness="0"
            UseAeroCaptionButtons="False" />
    </WindowChrome.WindowChrome>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>

        <!-- ヘッダー部分 -->
        <Grid Grid.Row="0" Height="45" Background="#FF4E4E4E" Margin="0, -5, 0, 0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="50"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="230"/>
                <ColumnDefinition Width="150"/>
            </Grid.ColumnDefinitions>

            <!-- アイコン -->
            <materialDesign:PackIcon Kind="MaterialDesign" Grid.Column="0" Foreground="White" Height="35" Width="35" HorizontalAlignment="Center" VerticalAlignment="Center"/>

            <!-- タイトル -->
            <Canvas Grid.Column="1">
                <Label Content="TUMUGU" FontSize="22" FontFamily="Arial Black" Foreground="White" Margin="0,1,0,0"/>
                <Label Content="- Markdown Editor -" FontSize="9" FontFamily="Arial Black" Foreground="WhiteSmoke" Margin="0,25,0,0"/>
            </Canvas>

            <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Left">
                <Button x:Name="BtnSave" Style="{DynamicResource MaterialDesignToolButton}" Height="40" Width="40" Click="BtnMinimize_Click" ToolTip="最小化" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <materialDesign:PackIcon Kind="ContentSave" Foreground="White" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button x:Name="BtnSaveAs" Style="{DynamicResource MaterialDesignToolButton}" Height="40" Width="40" Click="BtnClose_Click" ToolTip="終了" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3">
                    <materialDesign:PackIcon Kind="ContentSaveEdit" Foreground="White" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
            </StackPanel>

            <!-- ウィンドウのボタン -->
            <StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button x:Name="BtnMinimize" Style="{DynamicResource MaterialDesignToolButton}" Height="40" Width="40" Click="BtnMinimize_Click" ToolTip="最小化" HorizontalAlignment="Center" VerticalAlignment="Center">
                    <materialDesign:PackIcon Kind="Minus" Foreground="White" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button x:Name="BtnMaximize" Style="{DynamicResource MaterialDesignToolButton}" Height="40" Width="40" ToolTip="最小化" HorizontalAlignment="Center" VerticalAlignment="Center" Click="BtnMaximize_Click">
                    <materialDesign:PackIcon Kind="WindowMaximize" Foreground="White" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
                <Button x:Name="BtnClose" Style="{DynamicResource MaterialDesignToolButton}" Height="40" Width="40" Click="BtnClose_Click" ToolTip="終了" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="3">
                    <materialDesign:PackIcon Kind="Close" Foreground="White" Height="30" Width="30" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                </Button>
            </StackPanel>
        </Grid>

        <!-- ボディ部分 -->
        <Grid Grid.Row="1" Height="Auto" Background="White">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!-- Markdownの入力TextBox -->
            <TextBox x:Name="MarkdownTextBox" Grid.Row="0" Grid.Column="0" 
                     VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                     FontSize="16" Margin="10" BorderThickness="1"
                     AllowDrop="True" AcceptsReturn="True" AcceptsTab="True" TextWrapping="Wrap"
                     Drop="MarkdownTextBox_Drop" PreviewDragOver="MarkdownTextBox_PreviewDragOver"
                     TextChanged="MarkdownTextBox_TextChanged"
                     PreviewMouseWheel="MarkdownTextBox_PreviewMouseWheel" PreviewDragLeave="MarkdownTextBox_PreviewDragLeave"/>

            <!-- TextBoxとWebView2の中央に左右の画面サイズ変更のため配置 -->
            <GridSplitter Grid.Row="1" Grid.Column="1" Width="6" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="LightGray" ShowsPreview="True"/>

            <!-- MarkdownのPreview(HTML) -->
            <!-- MarkdownをHTMLで表示するため、NugetからMicrosoft.Web.WebView2をインストール -->
            <wv2:WebView2 x:Name="MarkdownBrowser" Grid.Row="1" Grid.Column="2" Margin="10"/>
        </Grid>


        <Grid Grid.Row="2" Height="30" Background="#414141">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="150"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <Label Grid.Column="0" x:Name="lblVersion" Content="Ver 1.0.0 評価版" Foreground="White" HorizontalAlignment="Left" VerticalAlignment="Center" Margin="20,0,0,0" FontSize="12"/>
        </Grid>
    </Grid>
</Window>
